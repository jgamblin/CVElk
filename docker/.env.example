# CVElk Environment Variables
# Copy this file to .env and fill in the values

# =============================================================================
# ELASTICSEARCH SETTINGS
# =============================================================================

# Elasticsearch host URL (for local/self-hosted)
ELASTICSEARCH_HOST=https://localhost:9200

# Elasticsearch credentials (required when security is enabled)
ELASTIC_PASSWORD=changeme
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=changeme

# For Elastic Cloud deployments
# ELASTICSEARCH_CLOUD_ID=your-deployment:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJGFiY2RlZg==
# ELASTICSEARCH_API_KEY_ID=your-api-key-id
# ELASTICSEARCH_API_KEY=your-api-key-secret

# Index name for CVE data
ELASTICSEARCH_INDEX_NAME=cves

# SSL/TLS settings
ELASTICSEARCH_VERIFY_CERTS=true
# ELASTICSEARCH_CA_CERTS=/path/to/ca.crt

# =============================================================================
# KIBANA SETTINGS
# =============================================================================

# Kibana host URL
KIBANA_HOST=https://localhost:5601

# Kibana credentials (if different from Elasticsearch)
KIBANA_PASSWORD=changeme
KIBANA_USERNAME=elastic

# Kibana space (default: "default")
KIBANA_SPACE_ID=default

# =============================================================================
# NVD API SETTINGS
# =============================================================================

# NVD API key (optional but recommended for higher rate limits)
# Get your free API key at: https://nvd.nist.gov/developers/request-an-api-key
# NVD_API_KEY=your-api-key-here

# Rate limit: 5 requests/30s without key, 50 requests/30s with key
NVD_RATE_LIMIT=5

# Results per page (max 2000)
NVD_RESULTS_PER_PAGE=2000

# =============================================================================
# EPSS SETTINGS
# =============================================================================

# EPSS data URL (default is the official FIRST.org feed)
EPSS_URL=https://epss.cyentia.com/epss_scores-current.csv.gz

# =============================================================================
# KEV SETTINGS
# =============================================================================

# CISA KEV catalog URL
KEV_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Data directory for downloads and cache
DATA_DIR=./data

# =============================================================================
# DOCKER SETTINGS
# =============================================================================

# Memory limits
ES_MEM_LIMIT=2147483648
KB_MEM_LIMIT=1073741824

# Port mappings
ES_PORT=9200
KIBANA_PORT=5601

# Elasticsearch license type: basic, trial
LICENSE=basic

# Encryption key for Kibana (must be at least 32 characters)
ENCRYPTION_KEY=your-32-character-encryption-key-here
